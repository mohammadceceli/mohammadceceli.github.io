{{- define "main" }}

{{- if site.Params.profileMode.enabled }}
{{- partial "index_profile.html" . }}
{{- else }}

<div class="main-wrapper">
  <!-- Sidebar سمت راست -->
  <aside class="sidebar">
    <div class="sidebar-section">
      <h3>مطالب پیشنهادی</h3>
      <ul class="suggested-posts">
        {{ range first 5 (where site.RegularPages "Section" "posts") }}
        <li class="suggested-post-item">
          <a href="{{ .Permalink }}" class="suggested-post-link">
            {{ if .Params.cover.image }}
            <img src="{{ .Params.cover.image | relURL }}" alt="{{ .Title }}" class="suggested-post-thumb">
            {{ end }}
            <div class="suggested-post-info">
              <h4>{{ .Title }}</h4>
             
            </div>
          </a>
        </li>
        {{ end }}
      </ul>
    </div>
  </aside>

  <!-- لیست مطالب سمت چپ -->
  <div class="posts-section">
    {{- if site.Params.homeInfoParams }}
    <article class="first-entry home-info">
      {{- with site.Params.homeInfoParams.Title }}
      <header class="entry-header">
        <h1>{{ . }}</h1>
      </header>
      {{- end }}
      {{- with site.Params.homeInfoParams.Content }}
      <div class="entry-content">{{ . }}</div>
      {{- end }}
      <footer class="entry-footer">
        {{- partial "social_icons.html" site.Params.socialIcons }}
      </footer>
    </article>
    {{- end }}

    {{- $pages := where site.RegularPages "Section" "posts" }}
    {{- $paginator := .Paginate $pages }}

    {{- range $index, $page := $paginator.Pages }}
    {{- $class := "post-entry" }}
    {{- $user_preferred := or site.Params.disableSpecial1stPost site.Params.homeInfoParams }}
    {{- if (and (eq $paginator.PageNumber 1) (eq $index 0) (not $user_preferred)) }}
    {{- $class = "first-entry" }}
    {{- else if $page.Params.hideSummary }}
    {{- $class = "post-entry tag-entry" }}
    {{- end }}

    <article class="{{ $class }}">
      {{- $isHidden := (site.Params.cover.hidden | default site.Params.cover.hiddenInList) }}
      {{- partial "cover.html" (dict "cxt" . "IsHome" true "isHidden" $isHidden) }}
      <header class="entry-header">
        <h2 class="entry-hint-parent">
          {{- .Title }}
          {{- if .Draft }}<sup><span class="entry-hint" title="Draft">[draft]</span></sup>{{- end }}
        </h2>
      </header>
      {{- if (ne (.Param "hideSummary") true) }}
      <div class="entry-content">
        <p>{{ .Summary | plainify | htmlUnescape }}{{ if .Truncated }}...{{ end }}</p>
      </div>
      {{- end }}
      {{- if not (.Param "hideMeta") }}
      <footer class="entry-footer">{{- partial "post_meta.html" . -}}</footer>
      {{- end }}
      <a class="entry-link" aria-label="post link to {{ .Title | plainify }}" href="{{ .Permalink }}"></a>
    </article>
    {{- end }}

    {{- if gt $paginator.TotalPages 1 }}
    <footer class="page-footer">
      <nav class="pagination">
        {{- if $paginator.HasPrev }}
        <a class="prev" href="{{ $paginator.Prev.URL | absURL }}">«&nbsp;قبلی</a>
        {{- end }}
        {{- if $paginator.HasNext }}
        <a class="next" href="{{ $paginator.Next.URL | absURL }}">بعدی&nbsp;»</a>
        {{- end }}
      </nav>
    </footer>
    {{- end }}
  </div>
</div>

{{- end }}{{- /* end profileMode */ -}}

{{- end }}{{- /* end main */ -}}